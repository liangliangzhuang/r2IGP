<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Simulation data analysis â€¢ r2IGP</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulation data analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">r2IGP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/sim-ana.html">Simulation data analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/liangliangzhuang/r2IGP/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Simulation data analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/liangliangzhuang/r2IGP/blob/main/vignettes/sim-ana.Rmd" class="external-link"><code>vignettes/sim-ana.Rmd</code></a></small>
      <div class="d-none name"><code>sim-ana.Rmd</code></div>
    </div>

    
    
<p>This article aims to analyze simulated degradation data using the
r2IGP package. It covers the simulation of degradation paths,
statistical inference through the EM algorithm and MLE, and
visualization of model behaviors. The goal is to provide insights into
parameter estimation and model evaluation for degradation modeling in
reliability analysis.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load necessary packages for simulation and analysis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://liangliangzhuang.github.io/r2IGP/">r2IGP</a></span><span class="op">)</span>        <span class="co"># Main package for the analysis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span>     <span class="co"># Pipe operator for cleaner code</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>    <span class="co"># Collection of packages for data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>      <span class="co"># Visualization library for plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span>      <span class="co"># Color scales for ggplot2</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span>      <span class="co"># Additional plotting functions</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nanx.me/ggsci/" class="external-link">ggsci</a></span><span class="op">)</span>        <span class="co"># Scientific color palettes</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">statmod</span><span class="op">)</span>      <span class="co"># Statistical modeling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com" class="external-link">plotly</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="parameter-setting">Parameter Setting<a class="anchor" aria-label="anchor" href="#parameter-setting"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define simulation parameters</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span>       <span class="co"># Number of products</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">40</span>       <span class="co"># Number of observation times</span></span>
<span><span class="va">types</span> <span class="op">&lt;-</span> <span class="st">"pp"</span> <span class="co"># Type of degradation model (pp: power x power)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">0.8</span><span class="op">)</span> </span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span>     </span>
<span><span class="va">kappa</span> <span class="op">&lt;-</span> <span class="fl">5</span>           </span>
<span><span class="va">sigma2</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>        <span class="co"># Variance for noise</span></span>
<span></span>
<span><span class="co"># Define time scale</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="va">m</span></span>
<span><span class="co"># Define degradation path for each product (same time scale for all products)</span></span>
<span><span class="va">t_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span>, <span class="va">n</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="../reference/rrIG.html">rrIG</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">r</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># usage scale</span></span>
<span><span class="va">u_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span>, <span class="va">n</span><span class="op">)</span>  <span class="co"># List for each product's usage scale</span></span>
<span></span>
<span><span class="co"># Define random effects for each product</span></span>
<span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">kappa</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sigma2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># All parameters</span></span>
<span><span class="va">para</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">beta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">alpha</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">beta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">kappa</span>, <span class="va">sigma2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulate-data">Simulate Data<a class="anchor" aria-label="anchor" href="#simulate-data"></a>
</h2>
<p>The function <code><a href="../reference/sim.dat.path.html">sim.dat.path()</a></code> simulates degradation data
using different models. The available models are: <code>"M0"</code>,
<code>"M1"</code>, <code>"M2"</code>, <code>"M3"</code>,
<code>"M4"</code>. The model structures are detailed in our related
publications.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate data for model "M0"</span></span>
<span><span class="va">sim_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim.dat.path.html">sim.dat.path</a></span><span class="op">(</span></span>
<span>   model <span class="op">=</span> <span class="st">"M0"</span>, </span>
<span>   type <span class="op">=</span> <span class="va">types</span>, </span>
<span>   m <span class="op">=</span> <span class="va">m</span>, </span>
<span>   n <span class="op">=</span> <span class="va">n</span>, </span>
<span>   t <span class="op">=</span> <span class="va">t_list</span>, </span>
<span>   u <span class="op">=</span> <span class="va">u_list</span>, </span>
<span>   par <span class="op">=</span> <span class="va">para</span>, </span>
<span>   gamma <span class="op">=</span> <span class="va">gamma</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The degradation paths can be visualized. The left plot shows the
effects of two scales on product degradation, while the right plot shows
the final observed degradation data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualize degradation paths</span></span>
<span><span class="va">path_re</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/degradation.path.plot.summary.html">degradation.path.plot.summary</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"M0"</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sim_dat</span><span class="op">$</span><span class="va">Y_t</span>, <span class="va">sim_dat</span><span class="op">$</span><span class="va">X_t</span>, <span class="va">sim_dat</span><span class="op">$</span><span class="va">Z_t</span><span class="op">)</span>,</span>
<span>  t <span class="op">=</span> <span class="va">t</span>, u <span class="op">=</span> <span class="va">u</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Display the plots</span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">path_re</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="sim-ana_files/figure-html/unnamed-chunk-5-1.png" alt="Degradation path." width="576"><p class="caption">
Degradation path.
</p>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># path.3D.plot(model="M0", units = 10, time = t, cycles = u, loss = sim_dat$Y_t) </span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="statistical-inference">Statistical Inference<a class="anchor" aria-label="anchor" href="#statistical-inference"></a>
</h2>
<div class="section level3">
<h3 id="initial-values">Initial Values<a class="anchor" aria-label="anchor" href="#initial-values"></a>
</h3>
<p>We use the Gauss-Legendre Quadrature method
(<code><a href="../reference/gaussian_legendre_integral.html">gaussian_legendre_integral()</a></code>) for approximating the E-step
integration. Other methods like <em>Trapezoidal Approximation</em>
(<code><a href="../reference/trapezoidal_integral.html">trapezoidal_integral()</a></code>) and <em>Monte Carlo
Integration</em> (<code><a href="../reference/mc_integral.html">mc_integral()</a></code>) are also available.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define initial parameter values for different models</span></span>
<span><span class="va">init_params_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"M0"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"M1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="st">"M2"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"M3"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  <span class="st">"M4"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set model sequence</span></span>
<span><span class="va">model_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M0"</span>, <span class="st">"M1"</span>, <span class="st">"M2"</span>, <span class="st">"M3"</span>, <span class="st">"M4"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parameter settings</span></span>
<span><span class="va">max_iter</span> <span class="op">&lt;-</span> <span class="fl">5</span>      <span class="co"># Maximum number of EM iterations</span></span>
<span><span class="va">tol1</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">4</span>       <span class="co"># Tolerance level</span></span>
<span><span class="va">gl_point</span> <span class="op">&lt;-</span> <span class="fl">30</span>      <span class="co"># Number of points for Gauss-Legendre method</span></span>
<span><span class="va">approx.method</span> <span class="op">&lt;-</span> <span class="st">"gl"</span> <span class="co"># Use Gauss-Legendre Quadrature method</span></span>
<span></span>
<span><span class="co"># Initial parameter setup for each model</span></span>
<span><span class="va">u_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">u_list</span>, <span class="va">u_list</span>, <span class="va">u_list</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span><span class="op">)</span> <span class="co"># M0,M1,M2,M3t,M3u,M4t,M4u</span></span>
<span><span class="va">t_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">t_list</span>, <span class="va">t_list</span>, <span class="va">t_list</span>, <span class="va">t_list</span>, <span class="va">u_list</span>, <span class="va">t_list</span>, <span class="va">u_list</span><span class="op">)</span> </span></code></pre></div>
<p>We initialize parameters for different models based on their
parameter structures and perform the EM algorithm.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define initial guesses for each model</span></span>
<span><span class="va">init_params_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"M0"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"M1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, </span>
<span>  <span class="st">"M2"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"M3"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, </span>
<span>  <span class="st">"M3"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"M4"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>  <span class="st">"M4"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M0"</span>, <span class="st">"M1"</span>, <span class="st">"M2"</span>, <span class="st">"M3"</span>, <span class="st">"M3"</span>, <span class="st">"M4"</span>, <span class="st">"M4"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="em-computation">EM Computation<a class="anchor" aria-label="anchor" href="#em-computation"></a>
</h3>
<p>This section performs parameter estimation for different models using
the Expectation-Maximization (EM) algorithm. For each model, initial
parameter values are generated via the <code><a href="../reference/init.guess.html">init.guess()</a></code>
function. The EM algorithm is then applied using the <code><a href="../reference/EM.html">EM()</a></code>
function, with the Gauss-Legendre Quadrature method
(<code><a href="../reference/gaussian_legendre_integral.html">gaussian_legendre_integral()</a></code>) for E-step integration. For
models <code>M6</code> and <code>M7</code>, the <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code>
function is used for maximum likelihood estimation. The results are
stored in <code>em_para_re</code>, and if any errors occur during the
estimation, they are handled with <code><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch()</a></code>, ensuring that
the process continues even if some models fail to converge.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_store</span> <span class="op">&lt;-</span> <span class="va">data_detail</span> <span class="op">&lt;-</span> <span class="va">em_para</span> <span class="op">&lt;-</span> <span class="va">em_iter_list</span> <span class="op">&lt;-</span> <span class="va">inti_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">em_para_re</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">model_seq</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">q</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">model_seq</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">inti_par</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/init.guess.html">init.guess</a></span><span class="op">(</span></span>
<span>    model <span class="op">=</span> <span class="va">model_seq</span><span class="op">[</span><span class="va">q</span><span class="op">]</span>, <span class="va">types</span>, data <span class="op">=</span> <span class="va">sim_dat</span><span class="op">$</span><span class="va">diff_Y</span>,</span>
<span>    t_list <span class="op">=</span> <span class="va">t_seq</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>, u_list <span class="op">=</span> <span class="va">u_seq</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    init_param <span class="op">=</span> <span class="va">init_params_seq</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">q</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">em_para_re</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="va">inti_par</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>, <span class="va">M4.loglik</span>,</span>
<span>        types <span class="op">=</span> <span class="va">types</span>, t_list <span class="op">=</span> <span class="va">t_seq</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>,</span>
<span>        data <span class="op">=</span> <span class="va">sim_dat</span><span class="op">$</span><span class="va">diff_Y</span></span>
<span>      <span class="op">)</span><span class="op">$</span><span class="va">par</span>,</span>
<span>      error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">em_para</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="../reference/EM.html">EM</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">sim_dat</span><span class="op">$</span><span class="va">diff_Y</span>, par0 <span class="op">=</span> <span class="va">inti_par</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>, types <span class="op">=</span> <span class="va">types</span>,</span>
<span>        tol1 <span class="op">=</span> <span class="va">tol1</span>, max_iter <span class="op">=</span> <span class="va">max_iter</span>,</span>
<span>        t_list <span class="op">=</span> <span class="va">t_seq</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>, u_list <span class="op">=</span> <span class="va">u_seq</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>, model <span class="op">=</span> <span class="va">model_seq</span><span class="op">[</span><span class="va">q</span><span class="op">]</span>, n_points <span class="op">=</span> <span class="va">gl_point</span>,</span>
<span>        approx.method <span class="op">=</span> <span class="va">approx.method</span></span>
<span>      <span class="op">)</span>,</span>
<span>      error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="cn">NA</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">em_para_re</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">em_para</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">init_params_seq</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">em_para</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">par_re</span><span class="op">[</span><span class="va">em_para</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">iter</span>, <span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<blockquote>
<p><em>Note</em>: Since a large number of iterations of the EM algorithm
requires a certain amount of time, 50 is used as an example here (it has
not actually converged yet). Readers are welcome to modify it according
to their needs.</p>
</blockquote>
<!-- ### Plot EM Iterations -->
<!-- The `EM_iter_plot()` function visualizes the convergence of the EM algorithm through iteration plots. -->
<!-- ```{r eval=TRUE, include=TRUE, results='hide'} -->
<!-- # Define the names and order of parameters for each model -->
<!-- f_names_list <- list( -->
<!--   "M0" = list( -->
<!--     expression(hat(alpha)[t]), expression(hat(beta)[t]),  -->
<!--     expression(hat(alpha)[u]), expression(hat(beta)[u]),  -->
<!--     expression(hat(kappa)), expression(hat(sigma)^2) -->
<!--     ), -->
<!--   "M1" = list( -->
<!--     expression(hat(alpha)[t]), expression(hat(beta)[t]),  -->
<!--     expression(hat(alpha)[u]), expression(hat(beta)[u]),  -->
<!--     expression(hat(gamma)) -->
<!--     ), -->
<!--   "M2" = list( -->
<!--     expression(hat(alpha)[t]), expression(hat(beta)[t]),  -->
<!--     expression(hat(alpha)[u]), expression(hat(beta)[u]),  -->
<!--     expression(hat(kappa)), expression(hat(sigma)^2) -->
<!--     ), -->
<!--   "M3" = list( -->
<!--     expression(hat(alpha)), expression(hat(beta)),  -->
<!--     expression(hat(kappa)), expression(hat(sigma)^2) -->
<!--     ), -->
<!--   "M3" = list( -->
<!--     expression(hat(alpha)), expression(hat(beta)),  -->
<!--     expression(hat(kappa)), expression(hat(sigma)^2) -->
<!--     ), -->
<!--   "M4" = list( -->
<!--     expression(hat(alpha)), expression(hat(beta)),  -->
<!--     expression(hat(kappa)) -->
<!--     ), -->
<!--   "M4" = list( -->
<!--     expression(hat(alpha)), expression(hat(beta)),  -->
<!--     expression(hat(kappa)) -->
<!--     ) -->
<!-- ) -->
<!-- orders_list <- list( -->
<!--   "M0" = c("alpha_t", "beta_t", "alpha_u", "beta_u", "kappa", "sigma2"), -->
<!--   "M1" = c("alpha_t", "beta_t", "alpha_u", "beta_u", "gamma"), -->
<!--   "M2" = c("alpha_t", "beta_t", "alpha_u", "beta_u", "kappa", "sigma2"), -->
<!--   "M3" = c("alpha", "beta", "kappa", "sigma2"), "M3" = c("alpha", "beta", "kappa", "sigma2"), -->
<!--   "M4" = c("alpha", "beta", "gamma"), "M4" = c("alpha", "beta", "gamma") -->
<!-- ) -->
<!-- ``` -->
<!-- ```{r eval=TRUE, include=TRUE, results='hide'} -->
<!-- # Plot EM iteration results -->
<!-- iter_list <- list() -->
<!-- for (q in 1:5) { -->
<!--   em_iter_list[[q]] <- EM_iter_plot(em_para[[q]]$par_re[complete.cases(em_para[[q]]$par_re), ], -->
<!--     par = NULL, ncol = dim(em_para[[q]]$par_re)[2], ture_value = F, -->
<!--     orders = orders_list[[q]], f_names = f_names_list[[q]] -->
<!--   ) -->
<!-- } -->
<!-- cowplot::plot_grid(em_iter_list[[1]],  -->
<!--                    em_iter_list[[2]], -->
<!--                    em_iter_list[[3]], -->
<!--                    labels = c("M0", "M1", "M2"), -->
<!--                    ncol = 1 -->
<!--                    ) -->
<!-- cowplot::plot_grid(em_iter_list[[4]],  -->
<!--                    em_iter_list[[5]], -->
<!--                    labels = c("Time", "UV"), -->
<!--                    hjust = -0.2, -->
<!--                    ncol = 1 -->
<!--                    ) -->
<!-- ``` -->
</div>
<div class="section level3">
<h3 id="log-likelihood-and-aic-calculation">Log-Likelihood and AIC Calculation<a class="anchor" aria-label="anchor" href="#log-likelihood-and-aic-calculation"></a>
</h3>
<p>Log-likelihood and AIC are calculated for model comparison.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loglik</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">q</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">model_seq</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">loglik</span><span class="op">[</span><span class="va">q</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/Log.liklihod.html">Log.liklihod</a></span><span class="op">(</span></span>
<span>      model <span class="op">=</span> <span class="va">model_seq</span><span class="op">[</span><span class="va">q</span><span class="op">]</span>, </span>
<span>      est_par <span class="op">=</span> <span class="va">em_para_re</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>, </span>
<span>      data <span class="op">=</span> <span class="va">sim_dat</span><span class="op">$</span><span class="va">diff_Y</span>, </span>
<span>      t_list <span class="op">=</span> <span class="va">t_seq</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>, </span>
<span>      u_list <span class="op">=</span> <span class="va">u_seq</span><span class="op">[[</span><span class="va">q</span><span class="op">]</span><span class="op">]</span>, </span>
<span>      types <span class="op">=</span> <span class="va">types</span></span>
<span>      <span class="op">)</span>, </span>
<span>    <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># AIC computation</span></span>
<span><span class="va">aic</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">em_para_re</span>, <span class="va">length</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">loglik</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">aic</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="final-results">Final Results<a class="anchor" aria-label="anchor" href="#final-results"></a>
</h3>
<p>The final estimated parameters, log-likelihood, and AIC values are
presented in a summarized table.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Store and display final results</span></span>
<span><span class="va">sim_para</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="st">"M0"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">em_para_re</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="cn">NA</span>, after <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>  <span class="st">"M1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">em_para_re</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span>, after <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="st">"M2"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">em_para_re</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, <span class="cn">NA</span>, after <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>  <span class="st">"M3t"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">em_para_re</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">3</span><span class="op">)</span>, after <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="st">"M3u"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">em_para_re</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span><span class="op">)</span>, after <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"M4t"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">em_para_re</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span>, after <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"M4u"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span>, <span class="va">em_para_re</span><span class="op">[[</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">final_sim_para</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">sim_para</span>, <span class="va">loglik</span>, <span class="va">aic</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">final_sim_para</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">final_sim_para</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">final_sim_para</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha_t"</span>, <span class="st">"beta_t"</span>, <span class="st">"alpha_u"</span>,</span>
<span>                              <span class="st">"beta_u"</span>, <span class="st">"gamma"</span>, <span class="st">"kappa"</span>, </span>
<span>                              <span class="st">"sigma"</span>, <span class="st">"Loglik"</span>, <span class="st">"AIC"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the table</span></span>
<span><span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">final_sim_para</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="11%">
<col width="10%">
<col width="11%">
<col width="10%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="13%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">alpha_t</th>
<th align="right">beta_t</th>
<th align="right">alpha_u</th>
<th align="right">beta_u</th>
<th align="right">gamma</th>
<th align="right">kappa</th>
<th align="right">sigma</th>
<th align="right">Loglik</th>
<th align="right">AIC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">M0</td>
<td align="right">1.224</td>
<td align="right">4.256</td>
<td align="right">0.730</td>
<td align="right">1.557</td>
<td align="right">NA</td>
<td align="right">5.601</td>
<td align="right">0.286</td>
<td align="right">-112.512</td>
<td align="right">239.024</td>
</tr>
<tr class="even">
<td align="left">M1</td>
<td align="right">1.215</td>
<td align="right">4.232</td>
<td align="right">0.724</td>
<td align="right">1.543</td>
<td align="right">5.352</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">-117.382</td>
<td align="right">248.764</td>
</tr>
<tr class="odd">
<td align="left">M2</td>
<td align="right">1.222</td>
<td align="right">4.253</td>
<td align="right">0.728</td>
<td align="right">1.555</td>
<td align="right">NA</td>
<td align="right">5.384</td>
<td align="right">0.061</td>
<td align="right">-120.056</td>
<td align="right">254.112</td>
</tr>
<tr class="even">
<td align="left">M3t</td>
<td align="right">0.990</td>
<td align="right">0.618</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">2.507</td>
<td align="right">0.108</td>
<td align="right">-168.955</td>
<td align="right">351.910</td>
</tr>
<tr class="odd">
<td align="left">M3u</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1.092</td>
<td align="right">7.215</td>
<td align="right">NA</td>
<td align="right">4.440</td>
<td align="right">0.219</td>
<td align="right">-387.862</td>
<td align="right">789.724</td>
</tr>
<tr class="even">
<td align="left">M4t</td>
<td align="right">1.091</td>
<td align="right">6.590</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">4.029</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">-167.362</td>
<td align="right">348.724</td>
</tr>
<tr class="odd">
<td align="left">M4u</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">0.994</td>
<td align="right">0.587</td>
<td align="right">2.431</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">-387.813</td>
<td align="right">789.626</td>
</tr>
</tbody>
</table>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://zll-blog.netlify.app/" class="external-link">Liangliang Zhuang</a>, <a href="https://xu-ancha.github.io/" class="external-link">Ancha Xu</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
